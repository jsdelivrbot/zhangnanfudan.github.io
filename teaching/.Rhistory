?qchisq
qchisq(0)
qchisq(0,df=1)
qchisq(0.00001,df=1)
qchisq(0.05,df=19)
qchisq(0.95,df=19)
n <- 20
alpha <- .05
x <- rnorm(n, mean=0, sd=2)
UCL <- (n-1) * var(x) / qchisq(alpha, df=n-1)
UCL
qchisq(alpha, df=n-1)
p(10.11,df=19)
pchisq(10.11,df=19)
plot(dchisq(seq(0,100,by=1),df=19))
plot(dchisq(seq(0,100,by=1),df=19))
n <- 20
alpha <- .05
x <- rnorm(n, mean=0, sd=2)
UCL <- (n-1) * var(x) / qchisq(1-alpha, df=n-1)
UCL
qnorm(.975)
n <- 20
alpha <- .95
UCL <- replicate(1000, expr = {
x <- rnorm(n, mean = 0, sd = 2)
(n-1) * var(x) / qchisq(alpha, df = n-1)
} )
#count the number of intervals that contain sigma^2=4
sum(UCL > 4)
#or compute the mean to get the confidence level
mean(UCL > 4)
qchisq(.95,df=19)
qchisq(.05,df=19)
dev.off()
m <- 100000
g <- numeric(m)
for (i in 1:m) {
x <- rnorm(2)
g[i] <- abs(x[1] - x[2])
}
est <- mean(g)
est
2/sqrt(pi)
sd(g)/sqrt(m)
sqrt(sum((g - mean(g))^2)/(m*(m-1)))
# biased
sqrt(sum((g - mean(g))^2)) / m
sqrt((2-4/pi)/m)
n <- 20
m <- 1000
tmean <- numeric(m)
for (i in 1:m) {
x <- sort(rnorm(n))
tmean[i] <- sum(x[2:(n-1)]) / (n-2)
}
mse <- mean(tmean^2)
mse
sqrt(sum((tmean - mean(tmean))^2)) / m    #se
n <- 20
m <- 1000
tmean <- numeric(m)
for (i in 1:m) {
x <- sort(rnorm(n))
tmean[i] <- median(x)
}
mse <- mean(tmean^2)
mse
sqrt(sum((tmean - mean(tmean))^2)) / m    #se
n <- 20
m <- 1000
mse=numeric(10)
for(k in 0:9)
{
tmean <- numeric(m)
for (i in 1:m)
{
x <- sort(rnorm(n))
tmean[i] <- sum(x[(k+1):(n-k)]) / (n-2*k)
}
mse[k+1] <- mean(tmean^2)
}
plot(mse)
n <- 20
m <- 1000
mse=numeric(10)
for(k in 0:9)
{
tmean <- numeric(m)
for (i in 1:m)
{
x <- sort(rnorm(n))
tmean[i] <- sum(x[(k+1):(n-k)]) / (n-2*k)
}
mse[k+1] <- mean(tmean^2)
}
plot(mse)
set.seed(522)
n <- 20
K <- n/2 - 1
m <- 1000
mse <- matrix(0, n/2, 6)
trimmed.mse <- function(n, m, k, p) {
#MC est of mse for k-level trimmed mean of
#contaminated normal pN(0,1) + (1-p)N(0,100)
tmean <- numeric(m)
for (i in 1:m) {
sigma <- sample(c(1, 10), size = n,
replace = TRUE, prob = c(p, 1-p))
x <- sort(rnorm(n, 0, sigma))
tmean[i] <- sum(x[(k+1):(n-k)]) / (n-2*k)
}
mse.est <- mean(tmean^2)
se.mse <- sqrt(mean((tmean-mean(tmean))^2)) / sqrt(m)
return(c(mse.est, se.mse))
}
for (k in 0:K) {
mse[k+1, 1:2] <- trimmed.mse(n=n, m=m, k=k, p=1.0)
mse[k+1, 3:4] <- trimmed.mse(n=n, m=m, k=k, p=.95)
mse[k+1, 5:6] <- trimmed.mse(n=n, m=m, k=k, p=.9)
}
mse
n <- 20
alpha <- .05
x <- rnorm(n, mean=0, sd=2)
UCL <- (n-1) * var(x) / qchisq(alpha, df=n-1)
UCL
